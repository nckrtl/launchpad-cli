services:
  php-83:
    build:
      context: .
      dockerfile: Dockerfile.php83
    image: launchpad-php:8.3
    container_name: launchpad-php-83
    ports:
      - "8083:8080"
    volumes:
      - ./php.ini:/usr/local/etc/php/php.ini:ro
      - ./Caddyfile:/etc/frankenphp/Caddyfile:ro
    restart: unless-stopped
    networks:
      - launchpad
    healthcheck:
      test: ["CMD-SHELL", "curl -f http://localhost:8080/ || exit 1"]
      interval: 10s
      timeout: 5s
      retries: 3
      start_period: 10s

  php-84:
    build:
      context: .
      dockerfile: Dockerfile.php84
    image: launchpad-php:8.4
    container_name: launchpad-php-84
    ports:
      - "8084:8080"
    volumes:
      - ./php.ini:/usr/local/etc/php/php.ini:ro
      - ./Caddyfile:/etc/frankenphp/Caddyfile:ro
    restart: unless-stopped
    networks:
      - launchpad
    healthcheck:
      test: ["CMD-SHELL", "curl -f http://localhost:8080/ || exit 1"]
      interval: 10s
      timeout: 5s
      retries: 3
      start_period: 10s

  php-85:
    build:
      context: .
      dockerfile: Dockerfile.php85
    image: launchpad-php:8.5
    container_name: launchpad-php-85
    ports:
      - "8085:8080"
    volumes:
      - ./php.ini:/usr/local/etc/php/php.ini:ro
      - ./Caddyfile:/etc/frankenphp/Caddyfile:ro
    restart: unless-stopped
    networks:
      - launchpad
    healthcheck:
      test: ["CMD-SHELL", "curl -f http://localhost:8080/ || exit 1"]
      interval: 10s
      timeout: 5s
      retries: 3
      start_period: 10s

networks:
  launchpad:
    external: true
